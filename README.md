# vk2tg

Простая утилита на Go, которая читает последние посты со стены VK-группы и пересылает их в закрытый канал/чат Telegram.

## Подготовка

- Создайте сервисный токен VK с доступом к методу `wall.get` и сохраните его.
- Узнайте числовой ID группы VK (без ведущего минуса). Для `https://vk.com/public123` ID равен `123`.
- Создайте бота Telegram, получите его токен и добавьте бота администратором в нужный закрытый канал либо чат. Сохраните ID канала (можно использовать `@username` или числовой `-100...`).

## Запуск

```bash
export VK_API_TOKEN="vk1.a...."
export VK_GROUP_ID=123456
export TELEGRAM_BOT_TOKEN="12345:ABC..."
export TELEGRAM_CHAT_ID="-1001234567890"

GOCACHE=$(pwd)/.gocache go run ./cmd/vk2tg
```

Доступные флаги (значения можно задавать и через переменные окружения):

- `-vk-token` (`VK_API_TOKEN`) — токен VK.
- `-vk-group-id` (`VK_GROUP_ID`) — числовой ID группы.
- `-tg-token` (`TELEGRAM_BOT_TOKEN`) — токен Telegram-бота.
- `-tg-chat` (`TELEGRAM_CHAT_ID`) — ID канала/чата или `@username`.
- `-limit` (`VK_POST_LIMIT`, по умолчанию 20) — сколько последних постов забрать.
- `-timeout` (`VK2TG_TIMEOUT`, например `45s`) — общий тайм-аут выполнения.

Утилита запрашивает указанное количество постов, начиная с самых свежих, и отправляет их в Telegram в порядке от старых к новым. Для каждого поста в сообщение добавляется ссылка вида `https://vk.com/wall-<ID>_<post_id>`.

## Ограничения и доработки

- Пересылается только текст и ссылки; медиа (фото, видео, документы) не загружаются в Telegram.
- Нет хранения состояния, поэтому повторный запуск пересылает те же посты повторно.
- Для регулярной синхронизации запланируйте запуск (например, cron) и храните последний обработанный `post_id` в своей внешней системе.

## Проверка

```bash
GOCACHE=$(pwd)/.gocache go build ./...
```

Тестов пока нет — основная логика упирается во внешние API, поэтому для автотестов понадобится мок или запись ответов VK/TG.
